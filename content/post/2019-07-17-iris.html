---
title: "Iris Dataset"
author: "Jordan Schupbach"
date: 2019-07-17T21:13:14-05:00
categories: ["R"]
tags: ["Iris Dataset", "LDA"]
---



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The famous <span class="citation">[@fisher:1936]</span> (or <span class="citation">[@anderson:1936]</span>) iris data set gives the
measurements (in centimeters) of the sepal length and width, and petal length
and width for 50 flowers, each from one of three species of iris. The species
are <em>I. setosa</em>, <em>I versicolor</em>, and <em>I. virginica</em>. We provide images for each of the
three species in Figure . Researchers are interested in whether they can
identify the species from the set of the four measurements taken on the plants.
For this study, the focus is only on predicting <em>I. Setosa</em> versus <em>I. Versicolor.</em></p>
<div id="description-of-data" class="section level2">
<h2>Description of Data</h2>
<p>This dataset has 1 categorical variable (species) and 4 quantitative variables
(sepal length and width, and petal length and width; all measured in
centimeters). Again, the researchers are interested in predicting species from
the four measurements. We provide the first six lines of the dataset in Table
 and a five-number summary of the data in Table .
We also may want to subset our data by species and look at summary statistics.
Means for the two species of interest are given in Table .</p>
<p>These data were gathered by Dr. Edgar Anderson. The <em>Iris setosa</em>
and <em>Iris versicolor</em> were found growing together in the same colony.
The third species, <em>Iris virginica</em>, was from a different colony, as it
would be a ``circumstance which might considerably disturb both the mean values
and their variabilities.’’</p>
</div>
</div>
<div id="statistical-methods-used" class="section level1">
<h1>Statistical Methods Used</h1>
<p>To classify the two species of interest, <em>I. setosa</em> and <em>I. versicolor</em>, we use the
method of linear discriminant analysis following <span class="citation">[@fisher:1936]</span>. One assumption
of the method is that the covariates be independently normally distributed. We
check the assumption of normality by plotting histograms of four variables grouped
by species type in Figure . Further, we provide beanplots from
the  R package <span class="citation">[@beanplot]</span>, which assume a normal kernel
density. The two figures would suggest the assumption of normality is
reasonably met.</p>
<p>Linear discriminant analysis allows us to write an objective function of the form</p>
<p><span class="math display">\[ X = \lambda_1 x_1 + \lambda_2 x_2 + \lambda_3 x_3 + \lambda_4 x_4 \]</span></p>
<p>for which we classify an observation as either <em>I. Setosa</em> or <em>I. Versicolor</em>
depending on its value.</p>
</div>
<div id="summary-of-statistical-findings" class="section level1">
<h1>Summary of Statistical Findings</h1>
<p>We provide means for the two groups in Table . The LDA was
conducted in R <span class="citation">[@r]</span> using the  function from the
 package <span class="citation">[@mass:2002]</span>. Coefficients of discrimination are
given in Table . We see that we can write equation
 as</p>
<p><span class="math display">\[ X = -1.77 x_1 - 0.3 x_2 + 3.04 x_3 + 2.14 x_4 \]</span></p>
<p>Following <span class="citation">[@fisher:1936]</span>, we can take the coefficient for sepal width to be
unity (see Table ) and rewrite equation 
as</p>
<p><span class="math display">\[ X = x_1 + 0.17 x_2 - 1.71 x_3 - 1.21 x_4 \]</span></p>
<p>These equations can be used to score each observation on this new scale, and
classify the observation as either <em>I. setosa</em> or <em>I. virginica</em>. Figure
 shows the values of the scores for the two species according
to equation . We can see from the plot that the scores do an
impressive job in separating <em>I. setosa</em> and <em>I. virginica</em>. A confusion matrix
is given in Table . We see that the equation can perfectly separate
<em>I. setosa</em> plants from <em>I. virginica</em>.</p>
</div>
<div id="scope-of-inference" class="section level1">
<h1>Scope of Inference</h1>
<p>Since we did not randomly assign any treatment to treatment groups, no causal
inference can be inferred in this study. Further, since observations did not
come from a random sample, we cannot infer to a larger population than that
of the sample.</p>
</div>
<div id="appendix" class="section level1">
<h1>Appendix</h1>
<div id="tables" class="section level2">
<h2>Tables</h2>
<table>
<caption>
<span id="tab:dataset">Table 1: </span>First 6 lines of the dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
Sepal.Length
</th>
<th style="text-align:right;">
Sepal.Width
</th>
<th style="text-align:right;">
Petal.Length
</th>
<th style="text-align:right;">
Petal.Width
</th>
<th style="text-align:left;">
Species
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
5.1
</td>
<td style="text-align:right;">
3.5
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.9
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
3.6
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
5.4
</td>
<td style="text-align:right;">
3.9
</td>
<td style="text-align:right;">
1.7
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
</tbody>
</table>
<table style="text-align:center">
<caption>
<strong>Summary table of the four quantitative variables</strong>
</caption>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Statistic
</td>
<td>
N
</td>
<td>
Mean
</td>
<td>
St. Dev.
</td>
<td>
Min
</td>
<td>
Pctl(25)
</td>
<td>
Pctl(75)
</td>
<td>
Max
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Sepal.Length
</td>
<td>
150
</td>
<td>
5.843
</td>
<td>
0.828
</td>
<td>
4.300
</td>
<td>
5.100
</td>
<td>
6.400
</td>
<td>
7.900
</td>
</tr>
<tr>
<td style="text-align:left">
Sepal.Width
</td>
<td>
150
</td>
<td>
3.057
</td>
<td>
0.436
</td>
<td>
2.000
</td>
<td>
2.800
</td>
<td>
3.300
</td>
<td>
4.400
</td>
</tr>
<tr>
<td style="text-align:left">
Petal.Length
</td>
<td>
150
</td>
<td>
3.758
</td>
<td>
1.765
</td>
<td>
1.000
</td>
<td>
1.600
</td>
<td>
5.100
</td>
<td>
6.900
</td>
</tr>
<tr>
<td style="text-align:left">
Petal.Width
</td>
<td>
150
</td>
<td>
1.199
</td>
<td>
0.762
</td>
<td>
0.100
</td>
<td>
0.300
</td>
<td>
1.800
</td>
<td>
2.500
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
<table>
<caption>
<span id="tab:means">Table 2: </span>Group means
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Sepal.Width
</th>
<th style="text-align:right;">
Sepal.Length
</th>
<th style="text-align:right;">
Petal.Width
</th>
<th style="text-align:right;">
Petal.Length
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
3.428
</td>
<td style="text-align:right;">
5.006
</td>
<td style="text-align:right;">
0.246
</td>
<td style="text-align:right;">
1.462
</td>
</tr>
<tr>
<td style="text-align:left;">
versicolor
</td>
<td style="text-align:right;">
2.770
</td>
<td style="text-align:right;">
5.936
</td>
<td style="text-align:right;">
1.326
</td>
<td style="text-align:right;">
4.260
</td>
</tr>
</tbody>
</table>
<table>
<caption>
<span id="tab:scaling">Table 3: </span>Coefficients of linear discriminants
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
LD1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sepal.Width
</td>
<td style="text-align:right;">
-1.773845
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length
</td>
<td style="text-align:right;">
-0.300458
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width
</td>
<td style="text-align:right;">
3.035726
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length
</td>
<td style="text-align:right;">
2.142260
</td>
</tr>
</tbody>
</table>
<table>
<caption>
<span id="tab:scaling-unity">Table 4: </span>Coefficients of linear discriminants with first scaled to unity
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
LD1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sepal.Width
</td>
<td style="text-align:right;">
1.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length
</td>
<td style="text-align:right;">
0.1693823
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width
</td>
<td style="text-align:right;">
-1.7113818
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length
</td>
<td style="text-align:right;">
-1.2076926
</td>
</tr>
</tbody>
</table>
<table>
<caption>
<span id="tab:confusion-mat">Table 5: </span>Confusion Matrix
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
setosa
</th>
<th style="text-align:right;">
versicolor
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
setosa
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
versicolor
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
50
</td>
</tr>
</tbody>
</table>
</div>
<div id="figures" class="section level2">
<h2>Figures</h2>
<div class="figure"><span id="fig:irises"></span>
<img src="/post/2019-07-17-iris_files/figure-html/irises-1.png" alt="Three species of iris: I. Setosa, I. Virginica, I. Versicolor" width="672" />
<p class="caption">
Figure 1: Three species of iris: I. Setosa, I. Virginica, I. Versicolor
</p>
</div>
<div class="figure"><span id="fig:pairsplot"></span>
<img src="/post/2019-07-17-iris_files/figure-html/pairsplot-1.png" alt="A matrix of scatterplots of the quantitative variables" width="672" />
<p class="caption">
Figure 2: A matrix of scatterplots of the quantitative variables
</p>
</div>
<div class="figure"><span id="fig:histograms"></span>
<img src="/post/2019-07-17-iris_files/figure-html/histograms-1.png" alt="Histograms of covariates separated by species" width="672" />
<p class="caption">
Figure 3: Histograms of covariates separated by species
</p>
</div>
<div class="figure"><span id="fig:sep"></span>
<img src="/post/2019-07-17-iris_files/figure-html/sep-1.png" alt="Beanplots of the four quantitative variables by species" width="672" />
<p class="caption">
Figure 4: Beanplots of the four quantitative variables by species
</p>
</div>
<div class="figure"><span id="fig:scores"></span>
<img src="/post/2019-07-17-iris_files/figure-html/scores-1.png" alt="Linear discriminant scores for setosa and versicolor" width="672" />
<p class="caption">
Figure 5: Linear discriminant scores for setosa and versicolor
</p>
</div>
</div>
<div id="r-code" class="section level2">
<h2>R-code</h2>
<pre class="r"><code># Subset the data
iris_sub &lt;- subset(iris, iris$Species == &quot;setosa&quot; |
                   iris$Species == &quot;versicolor&quot;)
iris_sub$Species &lt;- factor(iris_sub$Species)
head(iris_sub)

# LDA
z &lt;- lda(Species ~ Sepal.Width + Sepal.Length + Petal.Width +
         Petal.Length, iris_sub, prior = c(1,1)/2)
preds &lt;- predict(z)$class

## Tables:
# Table 1
head(iris)
print(xtable(head(iris), caption = &quot;First 6 lines of the dataset&quot;,
             label = &quot;data-head&quot;),
      comment = FALSE)

# Table 2
summary(iris)
stargazer(iris, iqr = TRUE,
          type = &quot;latex&quot;, header = FALSE, label = &quot;summary&quot;,
          title = &quot;Summary table of the four quantitative variables&quot;)

# Table 3
z$mean
print(xtable(z$mean, label = &quot;means-tbl&quot;, caption = &quot;Group means&quot;),
      comment = FALSE)

# Table 4
z$scaling
print(xtable(z$scaling, label = &quot;scaling-tbl&quot;,
             caption = &quot;Coefficients of linear discriminants&quot;),
      comment = FALSE)

# Table 5
(1/z$scaling[1]) * z$scaling
print(xtable((1/z$scaling[1]) * z$scaling, label = &quot;scaling-unity-tbl&quot;,
  caption = &quot;Coefficients of linear discriminants with first scaled to unity&quot;),
      comment = FALSE)

# Table 6: Confusion Matrix
table(preds, iris_sub$Species)
print(xtable(table(preds, iris_sub$Species), label = &quot;confusion&quot;,
             caption = &quot;Confusion matrix&quot;),
      comment = FALSE)

## Figures
# Figure 1:
fig1 &lt;- rasterGrob(readPNG(&quot;../../assets/iris-images/iris_setosa.png&quot;), interpolate=TRUE)
fig2 &lt;- rasterGrob(readPNG(&quot;../../assets/iris-images/iris_virginica.png&quot;), interpolate=TRUE)
fig3 &lt;- rasterGrob(readPNG(&quot;../../assets/iris-images/iris_versicolor.png&quot;), interpolate=TRUE)
grid.arrange(fig1, fig2, fig3, ncol=3)

# Figure 2:
par(mar = c(5,4,4,3))
pairs.panels(iris[,1:4],
             labels = c(&quot;Sepal Length&quot;,
                        &quot;Sepal Width&quot;,
                        &quot;Petal Length&quot;,
                        &quot;Petal Width&quot;),
             bg=c(&quot;red&quot;,
                  &quot;blue&quot;,
                  &quot;green&quot;)[iris$Species],
             pch=20+as.numeric(iris$Species),
             ellipses = FALSE,
             oma=c(4,4,6,12))
par(xpd=TRUE)
legend(.9*par(&quot;usr&quot;)[2],  ## 1.05 times x1 limit
       .7*par(&quot;usr&quot;)[4],   ## .8 times y2 limit
       levels(iris$Species),
       pch = c(21,22,23),
       pt.bg = c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;))

# Figure 3:
plot1 &lt;- ggplot(iris, aes(x=Sepal.Length))
plot1&lt;- plot1 + geom_histogram(aes(fill = Species))
plot2 &lt;- ggplot(iris, aes(x=Sepal.Width))
plot2&lt;- plot2 + geom_histogram(aes(fill = Species))
plot3 &lt;- ggplot(iris, aes(x=Petal.Length))
plot3&lt;- plot3 + geom_histogram(aes(fill = Species))
plot4 &lt;- ggplot(iris, aes(x=Petal.Width))
plot4&lt;- plot4 + geom_histogram(aes(fill = Species))
theme_set(theme_gray(base_size = 18))
m&lt;-grid.arrange(plot1,plot2, plot3,plot4, ncol=2)
print(m)


# Figure 4:
par(mfrow = c(2,2))
beanplot(Sepal.Length ~ Species, data = iris, ylab = &quot;Sepal Length&quot;,
         xlab = &quot;Species&quot;, col = &quot;beige&quot;, method = &quot;jitter&quot;)
beanplot(Sepal.Width ~ Species, data = iris, ylab = &quot;Sepal Width&quot;,
         xlab = &quot;Species&quot;, col = &quot;beige&quot;, method = &quot;jitter&quot;)
beanplot(Petal.Length ~ Species, data = iris, ylab = &quot;Petal Length&quot;,
         xlab = &quot;Species&quot;, col = &quot;beige&quot;, method = &quot;jitter&quot;)
beanplot(Petal.Width ~ Species, data = iris, ylab = &quot;Petal Width&quot;,
         xlab = &quot;Species&quot;, col = &quot;beige&quot;, method = &quot;jitter&quot;)

# Figure 5:
plot(z)</code></pre>
</div>
<div id="document-creation-info" class="section level2">
<h2>Document Creation Info</h2>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
</div>
